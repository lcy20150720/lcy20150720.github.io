<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<link rel="stylesheet" href="css/index.css">
	<link rel="stylesheet" href="css/JmCalendar.css">
</head>
<body>
	<svg aria-hidden="true" style="position: absolute; width: 0px; height: 0px; overflow: hidden;">
		<symbol viewBox="0 0 44 44" id="icon-arrow">
	         <path d="M22.6527924,12.6979839 L34.9095035,22.9825857 C35.1896977,23.2176965 35.4093809,23.4981636 35.5668253,23.8042387 C35.8425389,24.2235593 36.0024414,24.725194 36.0024414,25.2641758 C36.0024414,26.7369351 34.8085341,27.9308425 33.3357747,27.9308425 L6.66910807,27.9308425 C5.19634874,27.9308425 4.00244141,26.7369351 4.00244141,25.2641758 C4.00244141,23.7914165 5.19634874,22.5975091 6.66910807,22.5975091 L26.1524414,22.5970403 L19.2245918,16.7835543 C18.0963927,15.8368828 17.9492355,14.1548679 18.8959069,13.0266688 C19.8425784,11.8984697 21.5245933,11.7513125 22.6527924,12.6979839 Z" id="形状结合" fill="#CCCCCC"></path>
	    </symbol>
	    <symbol viewBox="0 0 40 40" id="toast-fail">
	        <path
	                d="M19.5290781,0.423943178 C20.0943357,-0.141314393 21.0107993,-0.141314393 21.5760568,0.423943178 C22.1413144,0.989200749 22.1413144,1.90566435 21.5760568,2.47092192 L21.5760568,2.47092192 L13.047,11 L21.5760568,19.5290781 C22.1413144,20.0943357 22.1413144,21.0107993 21.5760568,21.5760568 C21.0107993,22.1413144 20.0943357,22.1413144 19.5290781,21.5760568 L11,13.047 L2.47092192,21.5760568 C1.94099295,22.1059858 1.1023868,22.1391064 0.533873181,21.6754185 L0.423943178,21.5760568 C-0.141314393,21.0107993 -0.141314393,20.0943357 0.423943178,19.5290781 L0.423943178,19.5290781 L8.953,11 L0.423943178,2.47092192 C-0.141314393,1.90566435 -0.141314393,0.989200749 0.423943178,0.423943178 C0.989200749,-0.141314393 1.90566435,-0.141314393 2.47092192,0.423943178 L11,8.953 Z"
	                id="形状结合">
	        </path>
    	</symbol>
    	<symbol viewBox="0 0 44 44" id="icon-close">
        	<path
                d="M22,0 C34.1502645,0 44,9.8497355 44,22 C44,34.1502645 34.1502645,44 22,44 C9.8497355,44 0,34.1502645 0,22 C0,9.8497355 9.8497355,0 22,0 Z M16.5107937,12.6661905 C15.6516402,11.807037 14.2586773,11.807037 13.3995238,12.6661905 C12.5403704,13.5253439 12.5403704,14.9183069 13.3995238,15.7774603 L13.3995238,15.7774603 L19.622,22 L13.3995238,28.2225397 C12.5403704,29.0816931 12.5403704,30.4746561 13.3995238,31.3338095 C14.2586773,32.192963 15.6516402,32.192963 16.5107937,31.3338095 L22.733,25.111 L28.955873,31.3338095 C29.7741144,32.1520509 31.0765367,32.1910148 31.9408906,31.4507011 L32.0671428,31.3338095 C32.9262963,30.4746561 32.9262963,29.0816931 32.0671428,28.2225397 L32.0671428,28.2225397 L25.844,21.999 L32.0671428,15.7774603 C32.9262963,14.9183069 32.9262963,13.5253439 32.0671428,12.6661905 C31.2079894,11.807037 29.8150264,11.807037 28.955873,12.6661905 L22.733,18.888 Z"
                id="形状结合">
        	</path>
    	</symbol>
    	<symbol viewBox="0 0 44 44" id="icon-rg-open">
	        <path
	                d="M-5.01045817,34.2656492 L12.4558679,15.5162392 C12.7599095,15.1898626 13.2400905,15.1898626 13.5441321,15.5162392 L31.0104582,34.2656492 C31.9495702,35.2737488 33.4417196,35.2396977 34.3432671,34.189594 C35.2448147,33.1394902 35.2143626,31.4709867 34.2752506,30.4628871 L16.8089245,11.7134771 C14.6806335,9.42884095 11.3193665,9.42884095 9.19107548,11.7134771 L-8.27525062,30.4628871 C-9.21436264,31.4709867 -9.24481467,33.1394902 -8.34326713,34.189594 C-7.44171959,35.2396977 -5.94957019,35.2737488 -5.01045817,34.2656492 Z"
	                id="路径备份-2"
	                transform="translate(13.000000, 22.500000) rotate(-270.000000) translate(-13.000000, -22.500000) ">
	        </path>
	    </symbol>
	      <symbol viewBox="0 0 44 44" id="icon-add">
	        <path
	                d="M22,0 C23.6568542,0 25,1.40710507 25,3.14285714 L25,3.14285714 L25,19 L40.8571429,19 C42.5309038,19 43.8990733,20.24892 43.9946648,21.8237272 L44,22 C44,23.6568542 42.5928949,25 40.8571429,25 L40.8571429,25 L25,25 L25,40.8571429 C25,42.5309038 23.75108,43.8990733 22.1762728,43.9946648 L22,44 C20.3431458,44 19,42.5928949 19,40.8571429 L19,40.8571429 L19,24.999 L3.14285714,25 C1.46909622,25 0.100926698,23.75108 0.00533520262,22.1762728 L0,22 C0,20.3431458 1.40710507,19 3.14285714,19 L3.14285714,19 L19,18.999 L19,3.14285714 C19,1.46909622 20.24892,0.100926698 21.8237272,0.00533520262 Z"
	                id="形状结合"></path>
	    </symbol>
	    <symbol viewBox="0 0 44 44" id="icon-degree">
	        <path
	                d="M19,-14.8571429 L19,22.8571429 C19,24.5928949 20.4071051,26 22.1428571,26 C23.8786092,26 25.2857143,24.5928949 25.2857143,22.8571429 L25.2857143,-14.8571429 C25.2857143,-16.5928949 23.8786092,-18 22.1428571,-18 C20.4071051,-18 19,-16.5928949 19,-14.8571429 Z"
	                id="路径-2备份-2"
	                transform="translate(22.142857, 4.000000) rotate(-270.000000) translate(-22.142857, -4.000000) "></path>
	    </symbol>
	</svg>
	<div class="page_wrap">
		<div class="info_top">
			<div class="tabs">
				<div class="tab_top">
					<a href="javascript:;" class="tab_item tab_cur"><span>个人定制</span></a>
					<a href="javascript:;" class="tab_item"><span>企业/团队定制</span></a>
				</div>
				<div class="panels">
					<div class="tab_panel active">
						<div class="inp_wp">
							<input type="text" placeholder="目的地" value="惠州" class="target_area">
						</div>
						<div class="inp_wp clearfix">
							<div class="lf_input input_box">
								<input type="text" placeholder="出发日期" class="st_date" value="11月13日">
								<span class="weekend st_week">周四</span>
							</div>
							<span class="mid_icon">
								<svg class="icon-arrow" aria-hidden="true" width=".53rem" height=".53rem">
						            <use xlink:href="#icon-arrow" x="0" y="0" fill="#ccc" width=".53rem" height=".53rem"></use>
						        </svg>
					        </span>
					        <div class="rg_input input_box">
								<input type="text" placeholder="出发日期" class="nd_date" value="11月13日">
								<span class="weekend nd_week">周四</span>
							</div>
						</div>
						<a href="javascript:;" class="search_btn">免费获取专属行程方案</a>
					</div>
					<div class="tab_panel">
						<div class="inp_wp">
							<input type="text" placeholder="目的地" value="惠州" class="target_area">
						</div>
						<div class="inp_wp clearfix">
							<div class="lf_input input_box">
								<input type="text" placeholder="出发日期" class="st_date" value="11月13日">
								<span class="weekend">周四</span>
							</div>
							<span class="mid_icon">
								<svg class="icon-arrow" aria-hidden="true" width=".53rem" height=".53rem">
						            <use xlink:href="#icon-arrow" x="0" y="0" fill="#ccc" width=".53rem" height=".53rem"></use>
						        </svg>
					        </span>
					        <div class="rg_input input_box">
								<input type="text" placeholder="出发日期" class="st_date" value="11月13日">
								<span class="weekend">周四</span>
							</div>
						</div>
						<a href="javascript:;" class="search_btn">免费获取专属行程方案</a>
					</div>
				</div>
			</div>
		</div>
		<div class="steps">
			<img src="img/step_01.png" alt="">
			<img src="img/step_02.jpg" alt="">
		</div>
	</div>
	
	<!-- 目的地意向弹层 start-->
	<div class="pop_box">
		<div class="pop_shadow"></div>
		<div class="pop_inner">
			<div class="pop_head">填写目的地
				<a href="javascript:;" class="close_btn">
					<svg class="toast-fail" aria-hidden="true" width=".53rem" height=".53rem">
						<use xlink:href="#toast-fail" x="0" y="0" fill="#ccc" width=".53rem" height=".53rem"></use>
					</svg>
				</a>
			</div>
			<div class="pop_con">
				<div class="item_row">
					<h3 class="item_title">选择目的地意向<span>·必选，可多选</span></h3>
					<div class="items_wrap clearfix">
						<a href="javascript:;" class="sel_item cur">广东省内</a>
						<a href="javascript:;" class="sel_item">国内</a>
						<a href="javascript:;" class="sel_item">港澳</a>
						<a href="javascript:;" class="sel_item">出国</a>
					</div>
				</div>
				<div class="item_row">
					<h3 class="item_title">填写目的地<span>·必填</span></h3>
					<div class="input_wrap">
						<input type="text" placeholder="请输入您想去的目的地">
					</div>
				</div>
			</div>
			<div class="pop_foo">
				<a href="javascript:;" class="cancel_btn">取消</a>
				<a href="javascript:;" class="confirm_btn">确定</a>
			</div>
		</div>
	</div>
	<!-- 目的地意向弹层 end-->

	<script src="http://g.tbcdn.cn/mtb/lib-flexible/0.3.2/??flexible_css.js,flexible.js"></script>
	<script src="js/JmCalendar.js"></script>
	<script>
		window.addEventListener('load', function(){

			var calendar = new JmCalendar();
			calendar.init({
				months: 6,
				confirmType:'callback',
				cancelType:'callback',
				confirm: function(){
					var arr = this.selArea;
					var stInpObj = document.querySelector('.st_date');
					var ndInpObj = document.querySelector('.nd_date');
					var stWeekTxt = document.querySelector('.st_week');
					var ndWeekTxt = document.querySelector('.nd_week');

					if(arr.length>1){
						var stDateStr = arr[0];
						var ndDateStr = arr[1];
						var ft = function(t){return (t<10? '0' : '')+t};
						var stDate = ft(stDateStr.split('-')[2]);
						var stMonth = ft(stDateStr.split('-')[1]);
						var ndDate = ft(ndDateStr.split('-')[2]);
						var ndMonth = ft(ndDateStr.split('-')[1]);

						stInpObj.value = stMonth+'月'+stDate+'日';
						ndInpObj.value = ndMonth+'月'+ndDate+'日';
						stWeekTxt.innerHTML = getWeek(stDateStr);
						ndWeekTxt.innerHTML = getWeek(ndDateStr);
					}
					calendar._hide();
				},
				cancel: function(){
					calendar._hide();
				}
			});

			//获取星期
			var getWeek = function(nday){
				var now = new Date(nday);
		        var day = now.getDay();
		        var weeks = new Array("周日", "周一", "周二", "周三", "周四", "周五", "周六");
		        var week = weeks[day];
		        return week;
			}

			// tab切换
			var tabs = document.querySelectorAll('.tab_item');
			var panels = document.querySelectorAll('.tab_panel');

			if(tabs.length>0){
				for(var i=0; i<tabs.length; i++){
					(function(j){
						tabs[j].addEventListener('click', function(){
							for(var k=0; k<tabs.length; k++){
								if(tabs[k].className.indexOf('tab_cur') !=-1){
									tabs[k].classList.remove('tab_cur');
									panels[k].classList.remove('active');
								}
							}
							tabs[j].classList.add('tab_cur');
							panels[j].classList.add('active');
						})
					})(i)
				}
			}

			var stInp = document.querySelector('.st_date');
			stInp.addEventListener('click',	function(){
				calendar._show();
			})

			//显示弹出层
			var popBox = document.querySelector('.pop_box');
			var targetInp = document.querySelectorAll('.target_area');

			if(targetInp.length>0){
				for(var i=0; i<targetInp.length; i++){
					(function(j){
						targetInp[j].addEventListener('click', function(){
							if(popBox.className.indexOf('moved') ==-1){
								popBox.classList.add('moved');
							}
						});
					})(i)
				}
			}

			//关闭弹出层
			var closeBtn = popBox.querySelector('.close_btn');
			closeBtn.addEventListener('click', function(){
				popBox.classList.remove('moved');
			});

			//选择目的地意向
			var selItemList = popBox.querySelectorAll('.sel_item');
			if(selItemList.length>0){
				for(var i=0; i<selItemList.length; i++){
					(function(j){
						selItemList[j].addEventListener('click', function(){
							if(selItemList[j].className.indexOf('cur') == -1){
								selItemList[j].classList.add('cur');
							}else{
								selItemList[j].classList.remove('cur');
							}
						})
					})(i)
				}
			}

			var cancelBtn = popBox.querySelector('.cancel_btn');
			var confirmBtn = popBox.querySelector('.confirm_btn');

			//取消
			cancelBtn.addEventListener('click', function(){
				popBox.classList.remove('moved');
			});
			
			//确定
			confirmBtn.addEventListener('click', function(){
				popBox.classList.remove('moved');
			});
		})
	</script>
</body>
</html>